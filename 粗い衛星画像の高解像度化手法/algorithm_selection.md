# 衛星画像超解像システムのアルゴリズム選定

## 調査結果の概要

### 1. 超解像技術の調査結果

#### 深層学習ベースの超解像技術
- **SRCNN (Super-Resolution Convolutional Neural Network)**：初期の深層学習ベースの超解像モデル
- **SRGAN (Super-Resolution Generative Adversarial Network)**：敵対的生成ネットワークを用いた超解像モデル
- **ESRGAN (Enhanced Super-Resolution GAN)**：SRGANを改良したモデル、RRDBブロックを使用
- **Swin2SR**：Swinトランスフォーマーベースの超解像モデル、高い性能を示している

#### 従来の補間アルゴリズム
- **バイキュービック補間**：非線形補間アルゴリズム、画像の滑らかさを保持
- **ランチョス法**：高品質な補間が可能だが計算コストが高い

#### 5倍超解像の実装アプローチ
- **段階的拡大**：2倍→2倍→1.25倍のように段階的に拡大する手法
- **直接5倍拡大**：専用のアップサンプリング層を実装する必要がある
- **4倍拡大+補間**：4倍の超解像モデルを使用し、残りをバイキュービック補間で拡大

### 2. NASAの衛星データソースの調査結果

#### 利用可能なデータセット
- **NASA Open Data Portal (data.nasa.gov)**：多数の衛星データセットへのアクセスを提供
- **NASA Worldview**：衛星画像を視覚的に探索できるインタラクティブなインターフェース
- **Earthdata Search**：様々な解像度の衛星データを検索可能

#### 解像度情報
- 0-1メートル
- 1-30メートル
- 30-100メートル
- 100-250メートル
- 250-500メートル
- 500-1000メートル
- 1-10キロメートル

## 選定したアルゴリズムアプローチ

### 主要アルゴリズム：Swin2SR + バイキュービック補間

Solafuneコンペの上位解法を参考に、以下のアプローチを採用します：

1. **Swin2SR (x1 → x4)**：
   - 最新のトランスフォーマーベースの超解像モデル
   - 事前学習済みモデルが利用可能
   - 4倍までの超解像に高い性能を示している

2. **バイキュービック補間 (x4 → x5)**：
   - 4倍から5倍への拡大に効果的
   - 実装が容易で計算コストが低い

### データ拡張手法

以下のデータ拡張手法を採用します：
- **Brightness**：明るさの変更
- **Contrast**：コントラストの変更
- **Flip**：水平・垂直反転
- **Rotate**：90度単位の回転（エイリアシング問題を避けるため）
- **CutMix**：異なる画像の一部を組み合わせる手法

### 学習戦略

1. **初期学習段階**：
   - すべてのデータ拡張を適用
   - 比較的高い学習率で学習

2. **後期学習段階**：
   - CutMixを除外したデータ拡張を適用
   - 低い学習率で微調整

### 損失関数

- **SSIM Loss (1-SSIM)**：
  - 構造的類似性に基づく損失関数
  - 視覚的な品質向上に効果的

## 実装計画

1. **環境セットアップ**：
   - PyTorch、OpenCV、必要なライブラリのインストール
   - CUDA環境の構築（GPUを使用する場合）

2. **データ処理パイプライン**：
   - NASAの衛星データの前処理
   - データ拡張の実装
   - 訓練・検証データの分割

3. **モデル実装**：
   - Swin2SRモデルの実装または事前学習済みモデルの導入
   - 4倍から5倍への補間処理の実装

4. **学習プロセス**：
   - 2段階学習の実装
   - 損失関数の実装
   - 学習率スケジューリングの設定

5. **評価指標**：
   - PSNR（Peak Signal-to-Noise Ratio）
   - SSIM（Structural Similarity Index）
   - 視覚的評価

この実装計画に基づき、5倍の解像度向上を実現する衛星画像超解像システムを開発します。
